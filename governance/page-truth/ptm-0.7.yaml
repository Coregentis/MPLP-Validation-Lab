# Page Truth Map - v0.6
#
# GENERATED (Manual Sync) from Registry:
#   - governance/registry/ROUTES.yaml
#   - governance/registry/TRUTH_SOURCES.yaml
#   - governance/registry/GATES.yaml
#
# This file is the PROJECTION layer of the Registry三件套.
#
# Governance: REPO_SHAPE.md / VLAB-DGB-01

version: "0.7"
generated_at: "2026-01-23T14:45:00Z"
registry_sources:
  routes: "governance/registry/ROUTES.yaml"
  truth_sources: "governance/registry/TRUTH_SOURCES.yaml"
  gates: "governance/registry/GATES.yaml"

description: |
  v0.7 Page Truth Map transitions to "Provable Baseline".
  Includes Projection Manifest integrity (WP-07A) and 
  Projection Sanity assertions (WP-07B).

# =============================================================================
# Route Mappings (18 routes - 100% coverage)
# =============================================================================

routes:
  # ---------------------------------------------------------------------------
  # Home & Static Pages
  # ---------------------------------------------------------------------------
  - route: "/"
    version_scope: "v0.6"
    description: "Validation Lab home page"
    truth_sources:
      - "ts.identity"
      - "ts.dgb"
      - "ts.projection_manifest"
    gates:
      - "gate:key-policy"
      - "gate:projection-manifest"
      - "gate:04"
      - "gate:05"
    assertions:
      - type: "text_visible"
        text: "Validation Lab"
      - type: "text_visible"
        text: "Non-Endorsement"

  - route: "/about"
    version_scope: "v0.6"
    description: "About Validation Lab"
    truth_sources:
      - "ts.identity"
    gates:
      - "gate:key-policy"
    assertions:
      - type: "text_visible"
        text: "Validation Lab"

  - route: "/statement"
    version_scope: "v0.6"
    description: "Non-endorsement statement"
    truth_sources:
      - "ts.dgb"
    gates:
      - "gate:04"
      - "gate:05"
    assertions:
      - type: "text_visible"
        text: "Non-Endorsement"

  # ---------------------------------------------------------------------------
  # Runs (v0.2+)
  # ---------------------------------------------------------------------------
  - route: "/runs"
    version_scope: "v0.6"
    description: "Curated runs index"
    requires_ui_semantics: true
    truth_sources:
      - "ts.runsets"
      - "ts.curated_allowlist"
      - "ts.export_curated_json"
      - "ts.ui_curated_json"
      - "ts.substrate_index"
      - "ts.registry"
    gates:
      - "gate:terminology"
      - "gate:curated-runs"
      - "gate:ssot-consistency"
      - "gate:projection-sanity"
      - "gate:09"
    assertions:
      - type: "dom_exists"
        selector: "h2"
        text_contains: "Semantic Invariant Packs"
      - type: "source_consistency"
        rule: "List matches ts.runsets + ts.curated_json"
      - type: "run_count"
        source: "ts.runsets"
        min: 23

  - route: "/runs/[run_id]"
    version_scope: "v0.6"
    description: "Run detail page"
    route_family: true
    requires_ui_semantics: true
    truth_sources:
      - "ts.run_bundles"
      - "ts.registry"
    gates:
      - "gate:terminology"
      - "gate:shadow-parity"
      - "gate:ssot-consistency"
      - "gate:coverage-claim"
      - "gate:10"
    assertions:
      - type: "claim_verified"
        rule: "No Claim Without Artifact (gate:coverage-claim)"
      - type: "es_claim_protected"
        rule: "E-S requires signed_proof_ref"

  - route: "/runs/[run_id]/replay"
    version_scope: "v0.6"
    description: "Run replay page with timeline"
    route_family: true
    truth_sources:
      - "ts.run_bundles"
    gates:
      - "gate:terminology"

  - route: "/runs/[run_id]/evidence"
    version_scope: "v0.6"
    description: "Run evidence detail page"
    route_family: true
    truth_sources:
      - "ts.run_bundles"
    gates:
      - "gate:terminology"

  # ---------------------------------------------------------------------------
  # Guarantees
  # ---------------------------------------------------------------------------
  - route: "/guarantees"
    version_scope: "v0.6"
    description: "Lifecycle Guarantees (LG-01~05) overview"
    truth_sources:
      - "ts.terminology"
    gates:
      - "gate:terminology"

  # ---------------------------------------------------------------------------
  # Rulesets
  # ---------------------------------------------------------------------------
  - route: "/rulesets"
    version_scope: "v0.6"
    description: "Rulesets index"
    truth_sources:
      - "ts.registry"
      - "ts.ruleset_manifests"
    gates:
      - "gate:registry"

  - route: "/rulesets/[version]"
    version_scope: "v0.6"
    description: "Ruleset detail page"
    route_family: true
    truth_sources:
      - "ts.registry"
      - "ts.ruleset_manifests"
    gates:
      - "gate:registry"

  # ---------------------------------------------------------------------------
  # Adjudication
  # ---------------------------------------------------------------------------
  - route: "/adjudication"
    version_scope: "v0.6"
    description: "Adjudication entry page"
    truth_sources:
      - "ts.registry"
      - "ts.runsets"
      - "ts.dispute_benchmark"
    gates: []
    assertions:
      - type: "text_visible"
        text: "Dispute Benchmark"

  - route: "/adjudication/[run_id]"
    version_scope: "v0.6"
    description: "Adjudication detail page"
    route_family: true
    truth_sources:
      - "ts.run_bundles"
      - "ts.registry"
    gates:
      - "gate:14"

  # ---------------------------------------------------------------------------
  # Policies
  # ---------------------------------------------------------------------------
  - route: "/policies/contract"
    version_scope: "v0.6"
    description: "Evidence pack contract policy"
    truth_sources:
      - "ts.contracts"
      - "ts.coverage_addendum"
    gates:
      - "gate:coverage-claim"

  - route: "/policies/strength"
    version_scope: "v0.6"
    description: "Evidence strength policy"
    truth_sources:
      - "ts.strength"

  # ---------------------------------------------------------------------------
  # Builder & Coverage (v0.4+)
  # ---------------------------------------------------------------------------
  - route: "/builder"
    version_scope: "v0.6"
    description: "Evidence pack builder tool"
    truth_sources:
      - "ts.pack_schema"

  - route: "/coverage"
    version_scope: "v0.6"
    description: "Test coverage overview"
    truth_sources:
      - "ts.runsets"
      - "ts.test_vectors_allowlist"
      - "ts.coverage_addendum"
      - "ts.export_curated_json"
      - "ts.substrate_index"
      - "ts.coverage_matrix"
    gates:
      - "gate:test-vectors-coverage"
      - "gate:coverage-claim"
      - "gate:projection-manifest"
      - "gate:projection-sanity"
    assertions:
      - type: "matrix_projection"
        source: "adjudication/matrix/coverage.*.yaml"
      - type: "claim_verified"
        rule: "No Claim Without Artifact"

  # ---------------------------------------------------------------------------
  # Examples - Cross-Substrate Producers
  # ---------------------------------------------------------------------------
  - route: "/examples/evidence-producers/[substrate]"
    version_scope: "v0.6"
    description: "Cross-substrate evidence producer examples"
    route_family: true
    truth_sources:
      - "ts.producer_contract"
      - "ts.producer_manifests"
      - "ts.producer_packs"
    gates:
      - "gate:cross-substrate"

# =============================================================================
# Ruleset Requirements (must be loadable)
# =============================================================================

rulesets_required:
  - id: "ruleset-1.0"
    manifest: "data/rulesets/ruleset-1.0/manifest.yaml"
    adjudicator: "lib/rulesets/ruleset-1.0/adjudicate.ts"
  - id: "ruleset-1.1"
    manifest: "data/rulesets/ruleset-1.1/manifest.yaml"
    adjudicator: "lib/rulesets/ruleset-1.1/adjudicate.ts"
  - id: "ruleset-1.2"
    manifest: "data/rulesets/ruleset-1.2/manifest.yaml"
    adjudicator: "lib/rulesets/ruleset-1.2/adjudicate.ts"

# =============================================================================
# UI Test Samples (PTM-driven)
# =============================================================================

ui_test_samples:
  v02_pass: "gf-01-a2a-pass"
  v02_fail: "gf-01-a2a-fail"
  v03_pass: "arb-d1-budget-pass-fixture-v0.3"
  v03_fail: "arb-d1-budget-fail-fixture-v0.3"
  v04_pass: "arb-d1-budget-pass-fixture-v0.3"
  v04_fail: "arb-d1-budget-fail-outcome-invalid-v0.4"
  # Note: cross-substrate runs are verified by gate:cross-substrate, not ui_test_samples

# =============================================================================
# Summary
# =============================================================================

summary:
  total_routes: 18
  routes_with_gates: 15
  routes_with_exemptions: 3
  truth_sources_referenced: 20
  gates_referenced: 25
  coverage_percent: 100
